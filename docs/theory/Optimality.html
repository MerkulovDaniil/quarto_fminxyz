<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Optimality conditions. KKT</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script defer="" type="text/javascript" src="../../_scripts/toggle_button.js"></script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<meta name="twitter:title" content="Optimality conditions. KKT">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="./goodnews.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../logo.svg" alt="fmin.xyz" class="navbar-logo">
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto tools-wide">
    <a href="https://github.com/MerkulovDaniil/optim" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="https://www.youtube.com/@fmin" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-youtube"></i></a>
    <a href="https://t.me/fminxyz" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-telegram"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../docs/theory/index.html">Theory</a></li><li class="breadcrumb-item"><a href="../../docs/theory/Optimality.html">Optimality conditions. KKT</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/theory/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Matrix_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrix calculus</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/theory/convex sets/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Convex sets</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/convex sets/Affine_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Affine set</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/convex sets/Convex_set.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Convex set</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/convex sets/Conic_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conic set</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/convex sets/Projection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projection</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Convex_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Convex function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Conjugate_set.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conjugate set</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Conjugate function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conjugate function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Dual norm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dual norm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Subgradient.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Subgradient and subdifferential</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Optimality.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Optimality conditions. KKT</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Convex_optimization_problem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Convex optimization problem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Duality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Duality</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Balls_p_norm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Animation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Rates_of_convergence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rates of convergence</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/methods/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Methods</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/Simplex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LP and simplex algorithm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/Autograd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Adaptive Metrics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/adaptive_metrics/Newton.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Newton method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/adaptive_metrics/Quasi_newton.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quasi Newton methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/adaptive_metrics/adaptive_metric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Adaptive metric methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/adaptive_metrics/CG.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conjugate gradients</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/adaptive_metrics/KFAC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">KFAC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/adaptive_metrics/Natural_gradient.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Natural gradient descent</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">Fom</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/fom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">First order methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/GD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gradient descent</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/Subgradient descent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Subgradient descent</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/Projected_subgradient_descent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projected subgradient descent</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/Mirror_descent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mirror descent</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/SGD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stochastic gradient descent</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/SAG.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stochastic average gradient</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/ADAM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ADAM: A Method for Stochastic Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/Lookahead.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lookahead Optimizer: <span class="math inline">k</span> steps forward, <span class="math inline">1</span> step back</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/Shampoo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Shampoo: Preconditioned Stochastic Tensor Optimization</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Line Search</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/line_search/line_search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Line search</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/line_search/binary_search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Binary search</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/line_search/golden_search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Golden search</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/line_search/inexact.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inexact line search</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/line_search/parabola.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Successive parabolic interpolation</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
 <span class="menu-text">Zom</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/zom/zom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zero order methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/zom/bee_algorithm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bee algorithm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/zom/nelder-mead.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nelder–Mead</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/zom/simulated-annealing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulated annealing</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/exercises/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/matrix_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrix calculus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/convex_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Convex sets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/projection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projection</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/separation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Separation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/conjugate_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conjugate sets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/convex_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Convex functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/subgradient.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Subgradient and subdifferential</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/conjugate_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conjugate functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/gop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General optimization problems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/duality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Duality</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/convergence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rates of convergence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/line_search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Line search</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/cvxpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CVXPY library</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/automatic_differentiation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/zom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zero order methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/fom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">First order methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/uncategorized.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Uncategorized</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/applications/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Applications</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/A-Star.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="math inline">A^*</span> algorithm for path finding</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/deep_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deep learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/Eigenfaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Eigenfaces</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/ellipsoid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Minimum volume ellipsoid</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/knapsack_problem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Knapsack problem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/least_squares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear least squares</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/MLE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Maximum likelihood estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/Neural_Lipschitz_constant.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Neural network Lipschitz constant</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/NN_Loss_Surface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Neural Network Loss Surface Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principal component analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/rendezvous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rendezvous problem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/salesman_problem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Travelling salesman problem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/total_variation_inpainting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Total variation in-painting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/two_way_partitioning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Two way partitioning problem</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/benchmarks/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Benchmarks</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/benchmarks/CNN_on_Fashion_MNIST.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CNN on FashionMNIST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/benchmarks/linear_least_squares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Least Squares</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/materials/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Materials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/materials/tutorials/Colab tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quick start to the Colab</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/materials/tutorials/Tutorials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorials</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background">Background</a>
  <ul class="collapse">
  <li><a href="#extreme-value-weierstrass-theorem" id="toc-extreme-value-weierstrass-theorem" class="nav-link" data-scroll-target="#extreme-value-weierstrass-theorem">Extreme value (Weierstrass) theorem</a></li>
  <li><a href="#lagrange-multipliers" id="toc-lagrange-multipliers" class="nav-link" data-scroll-target="#lagrange-multipliers">Lagrange multipliers</a></li>
  </ul></li>
  <li><a href="#general-formulations-and-conditions" id="toc-general-formulations-and-conditions" class="nav-link" data-scroll-target="#general-formulations-and-conditions">General formulations and conditions</a>
  <ul class="collapse">
  <li><a href="#optimization-on-the-general-set-s." id="toc-optimization-on-the-general-set-s." class="nav-link" data-scroll-target="#optimization-on-the-general-set-s.">Optimization on the general set <span class="math display">S</span>.</a></li>
  <li><a href="#unconstrained-optimization" id="toc-unconstrained-optimization" class="nav-link" data-scroll-target="#unconstrained-optimization">Unconstrained optimization</a>
  <ul class="collapse">
  <li><a href="#general-case" id="toc-general-case" class="nav-link" data-scroll-target="#general-case">General case</a></li>
  <li><a href="#convex-case" id="toc-convex-case" class="nav-link" data-scroll-target="#convex-case">Convex case</a></li>
  </ul></li>
  <li><a href="#optimization-with-equality-conditions" id="toc-optimization-with-equality-conditions" class="nav-link" data-scroll-target="#optimization-with-equality-conditions">Optimization with equality conditions</a>
  <ul class="collapse">
  <li><a href="#intuition" id="toc-intuition" class="nav-link" data-scroll-target="#intuition">Intuition</a></li>
  <li><a href="#general-formulation" id="toc-general-formulation" class="nav-link" data-scroll-target="#general-formulation">General formulation</a></li>
  </ul></li>
  <li><a href="#optimization-with-inequality-conditions" id="toc-optimization-with-inequality-conditions" class="nav-link" data-scroll-target="#optimization-with-inequality-conditions">Optimization with inequality conditions</a>
  <ul class="collapse">
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#general-formulation-1" id="toc-general-formulation-1" class="nav-link" data-scroll-target="#general-formulation-1">General formulation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#karush-kuhn-tucker-conditions" id="toc-karush-kuhn-tucker-conditions" class="nav-link" data-scroll-target="#karush-kuhn-tucker-conditions">Karush-Kuhn-Tucker conditions</a>
  <ul class="collapse">
  <li><a href="#necessary-conditions" id="toc-necessary-conditions" class="nav-link" data-scroll-target="#necessary-conditions">Necessary conditions</a></li>
  <li><a href="#some-regularity-conditions" id="toc-some-regularity-conditions" class="nav-link" data-scroll-target="#some-regularity-conditions">Some regularity conditions</a></li>
  <li><a href="#sufficient-conditions" id="toc-sufficient-conditions" class="nav-link" data-scroll-target="#sufficient-conditions">Sufficient conditions</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/MerkulovDaniil/optim/edit/master/docs/theory/Optimality.md" class="toc-action">Edit this page</a></p></div></div></nav>
    <div class="quarto-margin-footer"><div class="margin-footer-item">
<button type="button" name="button" class="btn" id="toggleSpoilers">
🔽
</button>
</div></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Optimality conditions. KKT</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="background" class="level1">
<h1>Background</h1>
<section id="extreme-value-weierstrass-theorem" class="level2">
<h2 class="anchored" data-anchor-id="extreme-value-weierstrass-theorem">Extreme value (Weierstrass) theorem</h2>
<p>Let <span class="math display">S \subset \mathbb{R}^n</span> be a compact set and <span class="math display">f(x)</span> a continuous function on <span class="math display">S</span>. So that, the point of the global minimum of the function <span class="math display">f (x)</span> on <span class="math display">S</span> exists.</p>
<p><img src="./goodnews.png" class="img-fluid"></p>
</section>
<section id="lagrange-multipliers" class="level2">
<h2 class="anchored" data-anchor-id="lagrange-multipliers">Lagrange multipliers</h2>
<p>Consider simple yet practical case of equality constraints:</p>
<p><span class="math display">
\begin{split}
&amp; f(x) \to \min\limits_{x \in \mathbb{R}^n} \\
\text{s.t. } &amp; h_i(x) = 0, i = 1, \ldots, p
\end{split}
</span></p>
<p>The basic idea of Lagrange method implies the switch from conditional to unconditional optimization through increasing the dimensionality of the problem:</p>
<p><span class="math display">
L(x, \nu) = f(x) + \sum\limits_{i=1}^p \nu_i h_i(x) \to \min\limits_{x \in \mathbb{R}^n, \nu \in \mathbb{R}^p} \\
</span></p>
</section>
</section>
<section id="general-formulations-and-conditions" class="level1">
<h1>General formulations and conditions</h1>
<p><span class="math display">
f(x) \to \min\limits_{x \in S}
</span></p>
<p>We say that the problem has a solution if the budget set <strong>is not empty</strong>: <span class="math inline">x^* \in S</span>, in which the minimum or the infimum of the given function is achieved.</p>
<section id="optimization-on-the-general-set-s." class="level2">
<h2 class="anchored" data-anchor-id="optimization-on-the-general-set-s.">Optimization on the general set <span class="math display">S</span>.</h2>
<p>Direction <span class="math display">d \in \mathbb{R}^n</span> is a feasible direction at <span class="math display">x^* \in S \subseteq \mathbb{R}^n</span> if small steps along <span class="math display">d</span> do not take us outside of <span class="math display">S</span>.</p>
<p>Consider a set <span class="math display">S \subseteq \mathbb{R}^n</span> and a function <span class="math display">f : \mathbb{R}^n \to \mathbb{R}</span>. Suppose that <span class="math display">x^* \in S</span> is a point of local minimum for <span class="math display">f</span> over <span class="math display">S</span>, and further assume that <span class="math display">f</span> is continuously differentiable around <span class="math display">x^*</span>.</p>
<ol type="1">
<li><p>Then for every feasible direction <span class="math display">d \in \mathbb{R}^n</span> at <span class="math display">x^*</span> it holds that <span class="math display">\nabla f(x^*)^\top d \geq 0</span>.</p></li>
<li><p>If, additionally, <span class="math display">S</span> is convex then</p>
<p><span class="math display">
\nabla f(x^*)^\top(x − x^*) \geq 0, \forall x \in S.
</span></p></li>
</ol>
<p><img src="./general_first_order_local_optimality.svg" class="img-fluid"></p>
</section>
<section id="unconstrained-optimization" class="level2">
<h2 class="anchored" data-anchor-id="unconstrained-optimization">Unconstrained optimization</h2>
<section id="general-case" class="level3">
<h3 class="anchored" data-anchor-id="general-case">General case</h3>
<p>Let <span class="math display">f(x): \mathbb{R}^n \to \mathbb{R}</span> be a twice differentiable function.</p>
<p><span class="math display">
\tag{UP}
f(x) \to \min\limits_{x \in \mathbb{R}^n}
</span></p>
<p>If <span class="math display">x^*</span> - is a local minimum of <span class="math display">f(x)</span>, then:</p>
<p><span class="math display">
\tag{UP:Nec.}
\nabla f(x^*) = 0
</span></p>
<p>If <span class="math display">f(x)</span> at some point <span class="math display">x^*</span> satisfies the following conditions:</p>
<p><span class="math display">
\tag{UP:Suff.}
H_f(x^*) = \nabla^2 f(x^*) \succ (\prec) 0,
</span></p>
<p>then (if necessary condition is also satisfied) <span class="math display">x^*</span> is a local minimum(maximum) of <span class="math display">f(x)</span>.</p>
<p>Note, that if <span class="math display">\nabla f(x^*) = 0, \nabla^2 f(x^*) = 0</span>, i.e.&nbsp;the hessian is positive <em>semidefinite</em>, we cannot be sure if <span class="math display">x^*</span> is a local minimum (see <a href="https://en.wikipedia.org/wiki/Peano_surface">Peano surface</a> <span class="math display">f(x,y) = (2x^2 - y)(y - x^2)</span>).</p>
</section>
<section id="convex-case" class="level3">
<h3 class="anchored" data-anchor-id="convex-case">Convex case</h3>
<p>It should be mentioned, that in the <strong>convex</strong> case (i.e., <span class="math display">f(x)</span> is convex) necessary condition becomes sufficient. Moreover, we can generalize this result on the class of non-differentiable convex functions.</p>
<p>Let <span class="math display">f(x): \mathbb{R}^n \to \mathbb{R}</span>, then the point <span class="math display">x^*</span> is the solution of <span class="math display">\text{(UP)}</span> if and only if:</p>
<p><span class="math display">
0_n \in \partial f(x^*)
</span></p>
<p>One more important result for convex unconstrained case sounds as follows. If <span class="math display">f(x): S \to \mathbb{R}</span> - convex function defined on the convex set <span class="math display">S</span>, then: * Any local minima is the global one. * The set of the local minimizers <span class="math display">S^*</span> is convex. * If <span class="math display">f(x)</span> - strictly or strongly (different cases 😀) convex function, then <span class="math display">S^*</span> contains only one single point <span class="math display">S^* = x^*</span>.</p>
</section>
</section>
<section id="optimization-with-equality-conditions" class="level2">
<h2 class="anchored" data-anchor-id="optimization-with-equality-conditions">Optimization with equality conditions</h2>
<section id="intuition" class="level3">
<h3 class="anchored" data-anchor-id="intuition">Intuition</h3>
<p>Things are pretty simple and intuitive in unconstrained problem. In this section we will add one equality constraint, i.e.</p>
<p><span class="math display">
\begin{split}
&amp; f(x) \to \min\limits_{x \in \mathbb{R}^n} \\
\text{s.t. } &amp; h(x) = 0
\end{split}
</span></p>
<p>We will try to illustrate approach to solve this problem through the simple example with <span class="math display">f(x) = x_1 + x_2</span> and <span class="math display">h(x) = x_1^2 + x_2^2 - 2</span>.</p>
<p><img src="./eq_constr_1.svg" class="img-fluid"></p>
<p><img src="./eq_constr_2.svg" class="img-fluid"></p>
<p><img src="./eq_constr_3.svg" class="img-fluid"></p>
<p><img src="./eq_constr_4.svg" class="img-fluid"></p>
<p><img src="./eq_constr_5.svg" class="img-fluid"></p>
<p><img src="./eq_constr_6.svg" class="img-fluid"></p>
<p><img src="./eq_constr_7.svg" class="img-fluid"></p>
<p><img src="./eq_constr_8.svg" class="img-fluid"></p>
<p><img src="./eq_constr_9.svg" class="img-fluid"></p>
<p>Generally: in order to move from <span class="math display"> x_F </span> along the budget set towards decreasing the function, we need to guarantee two conditions:</p>
<p><span class="math display">
\langle \delta x, \nabla h(x_F) \rangle = 0
</span></p>
<p><span class="math display">
\langle \delta x, - \nabla f(x_F) \rangle &gt; 0
</span></p>
<p>Let’s assume, that in the process of such a movement we have come to the point where <span class="math display">
-\nabla f(x) = \nu \nabla h(x)
</span></p>
<p><span class="math display">
\langle  \delta x, - \nabla f(x)\rangle = \langle  \delta x, \nu\nabla h(x)\rangle = 0  
</span></p>
<p>Then we came to the point of the budget set, moving from which it will not be possible to reduce our function. This is the local minimum in the constrained problem :) <img src="./eq_constr_10.svg" class="img-fluid"></p>
<p>So let’s define a Lagrange function (just for our convenience):</p>
<p><span class="math display">
L(x, \nu) = f(x) + \nu h(x)
</span></p>
<p>Then the point <span class="math display"> x^* </span> is the local minimum of the problem described above, if and only if:</p>
<p><span class="math display">
\begin{split}
&amp; \text{Necessary conditions} \\
&amp; \nabla_x L(x^*, \nu^*) = 0 \text{ that's written above}\\
&amp; \nabla_\nu L(x^*, \nu^*) = 0 \text{ budget constraint}\\
&amp; \text{Sufficient conditions} \\
&amp; \langle y , \nabla^2_{xx} L(x^*, \nu^*) y \rangle &gt; 0,\\
&amp; \forall y \neq 0 \in \mathbb{R}^n : \nabla h(x^*)^\top y = 0
\end{split}
</span></p>
<p>We should notice that <span class="math display">L(x^*, \nu^*) = f(x^*)</span>.</p>
</section>
<section id="general-formulation" class="level3">
<h3 class="anchored" data-anchor-id="general-formulation">General formulation</h3>
<p><span class="math display">
\tag{ECP}
\begin{split}
&amp; f(x) \to \min\limits_{x \in \mathbb{R}^n} \\
\text{s.t. } &amp; h_i(x) = 0, \; i = 1,\ldots, p
\end{split}
</span></p>
<p>Solution</p>
<p><span class="math display">
L(x, \nu) = f(x) + \sum\limits_{i=1}^p\nu_i h_i(x) = f(x) + \nu^\top h(x)
</span></p>
<p>Let <span class="math display"> f(x) </span> and <span class="math display"> h_i(x) </span> be twice differentiable at the point <span class="math display"> x^* </span> and continuously differentiable in some neighborhood <span class="math display"> x^* </span>. The local minimum conditions for <span class="math display"> x \in \mathbb{R}^n, \nu \in \mathbb{R}^p </span> are written as</p>
<p><span class="math display">
\begin{split}
&amp; \text{ECP: Necessary conditions} \\
&amp; \nabla_x L(x^*, \nu^*) = 0 \\
&amp; \nabla_\nu L(x^*, \nu^*) = 0 \\
&amp; \text{ECP: Sufficient conditions} \\
&amp; \langle y , \nabla^2_{xx} L(x^*, \nu^*) y \rangle \geq 0,\\
&amp; \forall y \neq 0 \in \mathbb{R}^n : \nabla h_i(x^*)^\top y = 0
\end{split}
</span></p>
<p>Depending on the behavior of the Hessian, the critical points can have a different character.</p>
<p><img src="./critical.png" class="img-fluid"></p>
</section>
</section>
<section id="optimization-with-inequality-conditions" class="level2">
<h2 class="anchored" data-anchor-id="optimization-with-inequality-conditions">Optimization with inequality conditions</h2>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<p><span class="math display">
f(x) = x_1^2 + x_2^2 \;\;\;\; g(x) = x_1^2 + x_2^2 - 1
</span></p>
<p><span class="math display">
\begin{split}
&amp; f(x) \to \min\limits_{x \in \mathbb{R}^n} \\
\text{s.t. } &amp; g(x) \leq 0
\end{split}
</span></p>
<p><img src="./ineq_constr_1.svg" class="img-fluid"></p>
<p><img src="./ineq_constr_2.svg" class="img-fluid"></p>
<p><img src="./ineq_constr_3.svg" class="img-fluid"></p>
<p><img src="./ineq_constr_4.svg" class="img-fluid"></p>
<p>Thus, if the constraints of the type of inequalities are inactive in the constrained problem, then don’t worry and write out the solution to the unconstrained problem. However, this is not the whole story 🤔. Consider the second childish example</p>
<p><span class="math display">
f(x) = (x_1 - 1)^2 + (x_2 + 1)^2 \;\;\;\; g(x) = x_1^2 + x_2^2 - 1
</span></p>
<p><span class="math display">
\begin{split}
&amp; f(x) \to \min\limits_{x \in \mathbb{R}^n} \\
\text{s.t. } &amp; g(x) \leq 0
\end{split}
</span></p>
<p><img src="./ineq_constr_5.svg" class="img-fluid"></p>
<p><img src="./ineq_constr_6.svg" class="img-fluid"></p>
<p><img src="./ineq_constr_7.svg" class="img-fluid"></p>
<p><img src="./ineq_constr_8.svg" class="img-fluid"></p>
<p><img src="./ineq_constr_9.svg" class="img-fluid"></p>
<p><img src="./ineq_constr_10.svg" class="img-fluid"></p>
<p><img src="./ineq_constr_11.svg" class="img-fluid"></p>
<p>So, we have a problem:</p>
<p><span class="math display">
\begin{split}
&amp; f(x) \to \min\limits_{x \in \mathbb{R}^n} \\
\text{s.t. } &amp; g(x) \leq 0
\end{split}
</span></p>
<p>Two possible cases:</p>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math display">g(x) \leq 0</span> is inactive. <span class="math display">g(x^*) &lt; 0</span></th>
<th style="text-align: center;"><span class="math display">g(x) \leq 0</span> is active. <span class="math display">g(x^*) = 0</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math display">g(x^*) &lt; 0</span> <br> <span class="math display"> \nabla f(x^*) = 0 </span><br> <span class="math display">\nabla^2 f(x^*) &gt; 0</span></td>
<td style="text-align: center;">Necessary conditions <br> <span class="math display">g(x^*) = 0</span> <br> <span class="math display">- \nabla f(x^*) = \lambda \nabla g(x^*)</span>, <span class="math display">\lambda &gt; 0</span> <br> Sufficient conditions <br> <span class="math display">\langle y, \nabla^2_{xx} L(x^*, \lambda^*) y \rangle &gt; 0,</span> <br> <span class="math display">\forall y \neq 0 \in \mathbb{R}^n : \nabla g(x^*)^\top y = 0</span></td>
</tr>
</tbody>
</table>
<p>Combining two possible cases, we can write down the general conditions for the problem:</p>
<p><span class="math display">
\begin{split}
&amp; f(x) \to \min\limits_{x \in \mathbb{R}^n} \\
\text{s.t. } &amp; g(x) \leq 0 \\
&amp;
\end{split}
</span></p>
<p>Let’s define the Lagrange function:</p>
<p><span class="math display">
L (x, \lambda) = f(x) + \lambda g(x)
</span></p>
<p>The classical Karush-Kuhn-Tucker first and second order optimality conditions for a local minimizer <span class="math display">x^*</span>, stated under the linear independence constraint qualification (LICQ), can be written as follows:</p>
<p>If <span class="math display">x^*</span> is a local minimum of the problem described above, then there exists a unique Lagrange multiplier <span class="math inline">\lambda^*</span> such that:</p>
<p><span class="math display">
\begin{split}
    &amp; (1) \; \nabla_x L (x^*, \lambda^*) = 0 \\
    &amp; (2) \; \lambda^* \geq 0 \\
    &amp; (3) \; \lambda^* g(x^*) = 0 \\
    &amp; (4) \; g(x^*) \leq 0\\
    &amp; (5) \; \forall y \in C(x^*):  \langle y , \nabla^2_{xx} L(x^*, \lambda^*) y \rangle \geq 0 \\
    &amp;  \text{where } C(x^*) = \{y \ \in \mathbb{R}^n |  \nabla f(x^*) ^\top y \leq 0 \text{ and } \forall i \in I(x^*):  \nabla g_i(x^*)^⊤ y \leq 0
    \} \text{ is the critical cone.} \\
    &amp; I(x^*) = \{i| g_i(x^*) = 0\} \\
\end{split}
</span></p>
<p>It’s noticeable, that <span class="math display">L(x^*, \lambda^*) = f(x^*)</span>. Conditions <span class="math display">\lambda^* = 0 , (1), (4)</span> are the first scenario realization, and conditions <span class="math display">\lambda^* &gt; 0 , (1), (3)</span> - the second one.</p>
</section>
<section id="general-formulation-1" class="level3">
<h3 class="anchored" data-anchor-id="general-formulation-1">General formulation</h3>
<p><span class="math display">
\begin{split}
&amp; f_0(x) \to \min\limits_{x \in \mathbb{R}^n}\\
\text{s.t. } &amp; f_i(x) \leq 0, \; i = 1,\ldots,m\\
&amp; h_i(x) = 0, \; i = 1,\ldots, p
\end{split}
</span></p>
<p>This formulation is a general problem of mathematical programming.</p>
<p>The solution involves constructing a Lagrange function:</p>
<p><span class="math display">
L(x, \lambda, \nu) = f_0(x) + \sum\limits_{i=1}^m \lambda_i f_i(x) + \sum\limits_{i=1}^p\nu_i h_i(x)
</span></p>
</section>
</section>
</section>
<section id="karush-kuhn-tucker-conditions" class="level1">
<h1>Karush-Kuhn-Tucker conditions</h1>
<p>{% include tabs.html bibtex = ‘<span class="citation" data-cites="misc">@misc</span>{kuhn1951nonlinear, title={Nonlinear programming, in (J. Neyman, ed.) Proceedings of the Second Berkeley Symposium on Mathematical Statistics and Probability}, author={Kuhn, Harold W and Tucker, Albert W}, year={1951}, publisher={University of California Press, Berkeley} }’ file=‘/assets/files/kuhntucker.pdf’ inline = ‘True’%}</p>
<p>{% include tabs.html bibtex = ‘<span class="citation" data-cites="article">@article</span>{karush1939minima, title={Minima of functions of several variables with inequalities as side constraints}, author={Karush, William}, journal={M. Sc. Dissertation. Dept. of Mathematics, Univ. of Chicago}, year={1939} }’ file=‘/assets/files/karush.pdf’ inline = ‘True’%}</p>
<section id="necessary-conditions" class="level2">
<h2 class="anchored" data-anchor-id="necessary-conditions">Necessary conditions</h2>
<p>Let <span class="math display">x^*</span>, <span class="math display">(\lambda^*, \nu^*)</span> be a solution to a mathematical programming problem with zero duality gap (the optimal value for the primal problem <span class="math display">p^*</span> is equal to the optimal value for the dual problem <span class="math display">d^*</span>). Let also the functions <span class="math display"> f_0, f_i, h_i </span> be differentiable.</p>
<ul>
<li>$<span class="math inline">\nabla_x L(x^*, \lambda^*, \nu^*) = 0</span>$</li>
<li>$<span class="math inline">\nabla_\nu L(x^*, \lambda^*, \nu^*) = 0</span>$</li>
<li>$$ ^*_i , i = 1,,m$$</li>
<li>$<span class="math inline">\lambda^*_i f_i(x^*) = 0, i = 1,\ldots,m</span>$</li>
<li>$<span class="math inline">f_i(x^*) \leq 0, i = 1,\ldots,m</span>$</li>
</ul>
</section>
<section id="some-regularity-conditions" class="level2">
<h2 class="anchored" data-anchor-id="some-regularity-conditions">Some regularity conditions</h2>
<p>These conditions are needed in order to make KKT solutions the necessary conditions. Some of them even turn necessary conditions into sufficient (for example, Slater’s). Moreover, if you have regularity, you can write down necessary second order conditions <span class="math display">\langle y , \nabla^2_{xx} L(x^*, \lambda^*, \nu^*) y \rangle \geq 0</span> with <em>semi-definite</em> hessian of Lagrangian.</p>
<ul>
<li><strong>Slater’s condition</strong>. If for a convex problem (i.e., assuming minimization, <span class="math display"> f_0,f_{i}</span> are convex and <span class="math display">h_{i}</span> are affine), there exists a point <span class="math display">x</span> such that <span class="math display">h(x)=0</span> and <span class="math display">f_{i}(x)&lt;0</span> (existance of a strictly feasible point), then we have a zero duality gap and KKT conditions become necessary and sufficient.</li>
<li><strong>Linearity constraint qualification</strong> If <span class="math display">f_{i}</span> and <span class="math display">h_{i}</span> are affine functions, then no other condition is needed.</li>
<li>For other examples, see <a href="https://en.wikipedia.org/wiki/Karush%E2%80%93Kuhn%E2%80%93Tucker_conditions#Regularity_conditions_(or_constraint_qualifications)">wiki</a>.</li>
</ul>
</section>
<section id="sufficient-conditions" class="level2">
<h2 class="anchored" data-anchor-id="sufficient-conditions">Sufficient conditions</h2>
<p>For smooth, non-linear optimization problems, a second order sufficient condition is given as follows. The solution <span class="math display"> x^{*},\lambda ^{*},\nu ^{*}</span>, which satisfies the KKT conditions (above) is a constrained local minimum if for the Lagrangian,</p>
<p><span class="math display">
L(x, \lambda, \nu) = f_0(x) + \sum\limits_{i=1}^m \lambda_i f_i(x) + \sum\limits_{i=1}^p\nu_i h_i(x)
</span></p>
<p>the following conditions hold:</p>
<p><span class="math display">
\begin{split}
&amp; \langle y , \nabla^2_{xx} L(x^*, \lambda^*, \nu^*) y \rangle &gt; 0 \\
&amp; \forall y \neq 0 \in \mathbb{R}^n : \nabla h_i(x^*)^\top y = 0, \nabla f_0(x^*) ^\top y \leq 0,\nabla f_j(x^*)^\top y \leq 0 \\
&amp; i = 1,\ldots, p \quad \forall j: f_j(x^*) = 0
\end{split}
</span></p>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<ul>
<li><a href="http://www.csc.kth.se/utbildning/kth/kurser/DD3364/Lectures/KKT.pdf">Lecture</a> on KKT conditions (very intuitive explanation) in course “Elements of Statistical Learning” @ KTH.</li>
<li><a href="https://link.springer.com/content/pdf/10.1007%2Fs11590-008-0096-3.pdf">One-line proof of KKT</a></li>
<li><a href="https://www.scirp.org/pdf/OJOp_2013120315191950.pdf">On the Second Order Optimality Conditions for Optimization Problems with Inequality Constraints</a></li>
<li><a href="https://www.ime.usp.br/~ghaeser/secondorder.pdf">On Second Order Optimality Conditions in Nonlinear Optimization</a></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>